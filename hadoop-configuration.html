<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Blogs by Stanliski</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Stanliski's Blog</h1>
        <p></p>

        <p class="view"><a href="https://github.com/Andy19890601/myblog">View the Project on GitHub <small>stanliski/myblog</small></a></p>


        <ul>
          <li><a href="https://github.com/Andy19890601/myblog/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/Andy19890601/myblog/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/Andy19890601/myblog">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hadoop三节点的搭建</h1>

<p>
 <h3>
<a id="rather-drive-stick" class="anchor" href="#rather-drive-stick" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hadoop 2.2下载</h3>
<p>
Hadoop2.2.0 我们可以直接从Apache官方网站下载。下载地址：http://mirror.esocc.com/apache/hadoop/common/stable/
</p>
<h3>Hadoop集群环境搭建准备</h3>
这里我们搭建一个由三台机器组成的集群：
<pre><code>
  Ip地址
   用户名   
  主机名
        系统
192.168.1.105  
  hadoop
 master
 Ubuntu  64bit   
192.168.1.120
  hadoop
 slave2    
 CentOS 64bit
192.168.1.104
  hadoop
 slave1
 CentOS 64bit
</code></pre>
<h4>1.通过如下配置master, slave1, slave2。<h4>
<h4>1) 通过vim /etc/hostname修改主机名。<h4>
<h4>2) 通过vim /etc/hosts修改/etc/hosts 文件，增加三台机器的ip和hostname的映射关系。
master，slave1，slave2三台主机安装ssh服务，实现各个节点间的无密码登录！
        进入slave1的～/.ssh目录下<h4>
<pre><code>
$ ssh-keygen
$ chmod 700 ~/.ssh/
$ cat id_rsa.pub >> authorized_keys
$ chmod 600 authorized_keys
$ scp authorized_keys hadoop@slave2:~/.ssh/
</code></pre>
<p>进入slave2的～/.ssh目录下<p>
<pre><code>$ ssh-keygen
$ chmod 700 ~/.ssh/
$ cat id_rsa.pub >> authorized_keys
$ chmod 600 authorized_keys
$ scp authorized_keys hadoop@master:~/.ssh/
</code></pre>
<p>进入master的～/.ssh目录下<p>
<pre><code>$ ssh-keygen
$ chmod 700 ~/.ssh/
$ cat id_rsa.pub >> authorized_keys
$ chmod 600 authorized_keys
$ scp authorized_keys hadoop@slave2:~/.ssh/
$ scp authorized_keys hadoop@slave1:~/.ssh/
</code></pre>
<p>
	经过这样的操作，三节点都能实现相互无密码访问
JDK安装:包含master，slave1， slave2三节点，最好位置统一,例如像本例一样安装在/opt/java/jdk目录下  
</p>
<h3>
	Hadoop 2.2安装  
</h3>
<p>由于hadoop集群中每个机器上面的配置基本相同，所以我们先在namenode上面进行配置部署，然后再复制到其他节点。所以这里的安装过程相当于在每台机器上面都要执行。
</p>
<h4>1.解压文件</h4>
<p>
	 将第一部分中下载的hadoop-2.2.tar.gz解压到/home/u(根据自己的目录进行替换)/路径下（或者将在64位机器上编译的结果存放在此路径下）。然后为了节省空间，可删除此压缩文件，或将其存放于其他地方进行备份。
注意：每台机器的安装路径要相同！！  
</p>
<h4>2.hadoop配置过程</h4>
<p>
配置之前，需要在master本地文件系统创建以下文件夹：
这里要涉及到的配置文件有6个：  
</p>
<pre>
<code>~/hadoop-2.2.0/etc/hadoop/hadoop-env.sh
~/hadoop-2.2.0/etc/hadoop/slaves
~/hadoop-2.2.0/etc/hadoop/core-site.xml
~/hadoop-2.2.0/etc/hadoop/hdfs-site.xml
~/hadoop-2.2.0/etc/hadoop/mapred-site.xml
~/hadoop-2.2.0/etc/hadoop/yarn-site.xml</code>
</pre>
<p>以上文件默认不存在的，可以复制相应的template文件获得。
配置文件1：hadoop-env.sh（slave1，slave2也需要配置）
修改JAVA_HOME值（export  JAVA_HOME=/opt/java/jdk）
配置文件2：slaves （这个文件里面保存所有slave节点）
写入以下内容：
slave1
slave2</p>
<h4>配置文件3：core-site.xml
</h4>
<pre>
<p>
<configuration>
	<property>
	  <name>hadoop.tmp.dir</name>
	  <value>/home/hadoop/tmp/hadoop-${user.name}</value>
	  <description>A base for other temporarydirectories.</description>
	</property>
	<property>
	   <name>fs.default.name</name>
	   <value>hdfs://master:8010</value>
	   <description>The name of the default file system.  A URI whose
	           scheme and authority determine the FileSystem implementation.  The
	              uri's scheme determines the config property (fs.SCHEME.impl) naming
	                 the FileSystem implementation class. The uri's authority is used to
	                    determine the host, port, etc. for a filesystem.</description>
	  </property> 
</configuration>
</p>
</pre>
<h4>配置文件4：hdfs-site.xml</h4>
<h4>配置文件5：mapred-site.xml</h4>
<h4>yarn-site.xml：暂时无需配置</h4>
<p>配置文件6：yarn-site.xml：暂时无需配置
</p>
<h3>3.复制到其他节点</h3>
<p>master通过scp命令(必须先配置好ssh服务)将配置文件传输给两个子节点slave1,slave2,下面以slave1为例</p> 
<pre>
<code>$ scp -r ~/hadoop-2.2.0 hadoop@slave1:~/
$ scp -r ~/hadoop-2.2.0 hadoop@slave2:~/</code>
</pre>
<h3>4.启动验证</h3>
<h4>1.启动hadoop<h4>
<p>进入安装目录：</p>
<pre><code>cd  ~/hadoop-2.2.0/</code></pre>
<p>格式化namenode：</p>
<pre><code>./bin/hdfs namenode –format </code></pre>
  <h4>2.启动hdfs:</h4>
 <pre><code>./sbin/start-dfs.sh</code></pre>
  <p>此时在master上面运行的进程有：</p>
  <pre>namenode secondarynamenode</pre>
   
  <p>slave1和slave2上面运行的进程有：datanode</p>
 
  <h4>3.启动yarn: ./sbin/start-yarn.sh</h4>
  <p>此时在master上面运行的进程有：</p>
  <pre><code>namenode secondarynamenoderesourcemanager</code></pre>
  <p>slave1和slave2上面运行的进程有：datanode nodemanaget</p>
  <h4>5.查看集群状态：</h4>
  <pre><code>./bin/hdfs dfsadmin –report</pre></code>

<h3>
<a id="designer-templates" class="anchor" href="#designer-templates" aria-hidden="true"><span class="octicon octicon-link"></span></a>Designer Templates</h3>

<p>We've crafted some handsome templates for you to use. Go ahead and continue to layouts to browse through them. You can easily go back to edit your page before publishing. After publishing your page, you can revisit the page generator and switch to another theme. Your Page content will be preserved if it remained markdown format.</p>

<h3>
<a id="rather-drive-stick" class="anchor" href="#rather-drive-stick" aria-hidden="true"><span class="octicon octicon-link"></span></a>Rather Drive Stick?</h3>

<p>If you prefer to not use the automatic generator, push a branch named <code>gh-pages</code> to your repository to create a page manually. In addition to supporting regular HTML content, GitHub Pages support Jekyll, a simple, blog aware static site generator written by our own Tom Preston-Werner. Jekyll makes it easy to create site-wide headers and footers without having to copy them across every page. It also offers intelligent blog support and other advanced templating features.</p>

<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>You can <a href="https://github.com/blog/821" class="user-mention">@mention</a> a GitHub username to generate a link to their profile. The resulting <code>&lt;a&gt;</code> element will link to the contributor's GitHub Profile. For example: In 2007, Chris Wanstrath (<a href="https://github.com/defunkt" class="user-mention">@defunkt</a>), PJ Hyett (<a href="https://github.com/pjhyett" class="user-mention">@pjhyett</a>), and Tom Preston-Werner (<a href="https://github.com/mojombo" class="user-mention">@mojombo</a>) founded GitHub.</p>

<h3>
<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>Having trouble with Pages? Check out the documentation at <a href="http://help.github.com/pages">http://help.github.com/pages</a> or contact <a href="mailto:support@github.com">support@github.com</a> and we’ll help you sort it out.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/Andy19890601">Stanliski</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
